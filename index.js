!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue")):"function"==typeof define&&define.amd?define(["vue"],t):(e=e||self).VueStorage=t(e.Vue)}(this,(function(e){"use strict";function t(e){return function(){return e}}function n(e){return"function"==typeof e}function i(e){return n(e)?e:t(e)}function o(e){return e}function r(){}function s(e){if(e){var t=typeof e;return"object"===t||"function"===t}return!1}function u(e){return void 0===e}function a(e){return u(e)||function(e){return null===e}(e)}e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var f=function(e){this.setOwnItem(e.key,e.newValue)};var c={created:function(){Object.assign(this,{items:new Map})},methods:{getItem:function(t){var n=this.items,i=n.get(t);if(!i){var o=this.storage,r=o?o.getItem(t):null;i=e.observable({value:r}),n.set(t,i)}return i.value},setItem:function(e,t){this.setStorageItem(e,t),this.setOwnItem(e,t)},setOwnItem:function(e,t){var n=this.items.get(e);n&&(a(t)&&(t=null),Object.assign(n,{value:t}))},setStorageItem:function(e,t){var n=this.storage;n&&(a(t)?n.removeItem(e):n.setItem(e,t))}}},d={mixins:[c],computed:{storage:function(){if("undefined"!=typeof window)return window.localStorage},storageEventListener:function(){return f.bind(this)}},created:function(){"undefined"!=typeof window&&window.addEventListener("storage",this.storageEventListener)},beforeDestroy:function(){"undefined"!=typeof window&&window.removeEventListener("storage",this.storageEventListener)}};var l={mixins:[c],computed:{storage:function(){if("undefined"!=typeof window)return window.sessionStorage}}},g={install:function(e){Object.assign(e.config.optionMergeStrategies,{stored:function(e,t){return Object.assign({},e,t)}}),this.$localStorage=new e(d),this.$sessionStorage=new e(l),e.mixin(this)},computed:{},beforeCreate:function(){var e=this.$options,f=e.$localStorage,c=e.$sessionStorage,d=e.computed,l=e.stored;l&&Object.entries(l).forEach((function(e){var l=e[0],g=e[1],p=t(l),w=r,m=o,h=o,v=r;g===String||(g===JSON?(m=JSON.parse,h=JSON.stringify):s(g)&&(u(g.key)||(p=i(g.key)),g.type===String||(g.type===JSON?(m=JSON.parse,h=JSON.stringify):s(g.type)&&(n(g.type.parse)&&(m=g.type.parse),n(g.type.stringify)&&(h=g.type.stringify))),u(g.default)||(w=i(g.default)),u(g.session)||(v=i(g.session))));var y=function(){return v.call(this)?c:f};d[l]={get:function(){var e=p.call(this),t=y.call(this).getItem(e);return t=a(t)?w.call(this):m.call(this,t)},set:function(e){var t=p.call(this),n=y.call(this);e=h.call(this,e),n.setItem(t,e)}}}))}};return"undefined"!=typeof window&&window.Vue&&window.Vue.use(g),g}));
