!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue-demi")):"function"==typeof define&&define.amd?define(["exports","vue-demi"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VueStorage={},e.VueDemi)}(this,(function(e,t){"use strict";const s=e=>"function"==typeof e;class i{constructor(e=null){Object.assign(this,{_items:{},_storage:e})}getItem(e){let{_items:s}=this,i=s[e];if(!i){let{_storage:r}=this,l=r?r.getItem(e):null;i=t.ref(l),s[e]=i}let{value:r}=i;return r}setItem(e,t){let{_storage:s}=this;s&&s.setItem(e,t),this._setItem(e,t)}_setItem(e,t){let{_items:s}=this,i=s[e];i&&(i.value="".concat(t))}removeItem(e){let{_storage:t}=this;t&&t.removeItem(e),this._removeItem(e)}_removeItem(e){let{_items:t}=this,s=t[e];s&&(s.value=null)}clear(){let{_storage:e}=this;e&&e.clear(),this._clear()}_clear(){let{_items:e}=this;Object.values(e).forEach((e=>{e.value=null}))}}var r=(()=>{let{window:e}=globalThis;if(e){let{localStorage:t}=e;if(t){let s=new i(t);return e.addEventListener("storage",(({key:e,newValue:t})=>{null==t?s._removeItem(e):s._setItem(e,t)})),s}}return new i})(),l=(()=>{let{window:e}=globalThis;if(e){let{sessionStorage:t}=e;if(t)return new i(t)}return new i})(),n={parse:e=>Boolean(JSON.parse(e)),stringify:e=>String(Boolean(e))},o={parse:e=>Number(JSON.parse(e)),stringify:e=>String(Number(e))},a={parse:String,stringify:String};function u(e,{default:i=null,session:u=!1,type:m=JSON}={}){let c=e=>s(e)?e:t.isRef(e)?()=>e.value:()=>e,g=c(e),f=c(i),d=c(u),h=()=>d()?l:r,{parse:v,stringify:p}=(e=>{switch(e){case Boolean:return n;case Number:return o;case String:return a}return e})(m);return t.computed({get(){let e=h(),t=g(),s=e.getItem(t);return s=null==s?f():v(s),s},set(e){let t=h(),s=g();null==e?t.removeItem(s):(e=p(e),t.setItem(s,e))}})}var m={computed:{},beforeCreate(){let{$options:e}=this,{computed:t,stored:i}=e;if(i){let e=(e,t)=>{let{key:i=t,...r}=Object.entries(e).reduce(((e,[t,i])=>(s(i)&&(i=i.bind(this)),e[t]=i,e)),{}),l=u(i,r);return{get:()=>l.value,set(e){l.value=e}}};Object.entries(i).forEach((([s,i])=>{t[s]=e(i,s)}))}}},c={stored:(e,t)=>({...e,...t})};function g(e){Object.assign(e.config.optionMergeStrategies,c),e.mixin(m)}let f={install:g};var d,h;t.isVue2&&(null===globalThis||void 0===globalThis||null===(d=globalThis.window)||void 0===d||null===(h=d.Vue)||void 0===h||h.use(f));e.default=f,e.install=g,e.localStorage=r,e.mixin=m,e.sessionStorage=l,e.stored=u,Object.defineProperty(e,"__esModule",{value:!0})}));
