!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue-demi")):"function"==typeof define&&define.amd?define(["exports","vue-demi"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VueStorage={},e.VueDemi)}(this,(function(e,t){"use strict";const r=e=>"function"==typeof e;class n{constructor(e=null){Object.assign(this,{_items:{},_storage:e})}getItem(e){let{_items:r}=this,n=r[e];if(!n){let{_storage:i}=this,s=i?i.getItem(e):null;n=t.ref(s),r[e]=n}let{value:i}=n;return i}setItem(e,t){let{_storage:r}=this;r&&r.setItem(e,t),this._setItem(e,t)}_setItem(e,t){let{_items:r}=this,n=r[e];n&&(n.value="".concat(t))}removeItem(e){let{_storage:t}=this;t&&t.removeItem(e),this._removeItem(e)}_removeItem(e){let{_items:t}=this,r=t[e];r&&(r.value=null)}clear(){let{_storage:e}=this;e&&e.clear(),this._clear()}_clear(){let{_items:e}=this;Object.values(e).forEach((e=>{e.value=null}))}}var i=(()=>{let{window:e}=globalThis;if(e){let{localStorage:t}=e;if(t){let r=new n(t);return e.addEventListener("storage",(({key:e,newValue:t})=>{null==t?r._removeItem(e):r._setItem(e,t)})),r}}return new n})(),s=(()=>{let{window:e}=globalThis;if(e){let{sessionStorage:t}=e;if(t)return new n(t)}return new n})();function o(e){return r(e)?e:t.isRef(e)?()=>e.value:()=>e}var l={parse:e=>Boolean(JSON.parse(e)),stringify:e=>String(Boolean(e))},u={parse:e=>Number(JSON.parse(e)),stringify:e=>String(Number(e))},a={parse:String,stringify:String};function c(e,{default:r=null,session:n=!1,type:c=JSON}={}){let f=o(e),m=o(r),g=o(n),d=()=>g()?s:i,{parse:p,stringify:h}=(e=>{switch(e){case Boolean:return l;case Number:return u;case String:return a}return e})(c);return t.computed({get(){let e=d(),t=f(),r=e.getItem(t);return r=null==r?m():p(r),r},set(e){let t=d(),r=f();null==e?t.removeItem(r):(e=h(e),t.setItem(r,e))}})}function f({optionName:e="stored",prefix:t=""}={}){return{computed:{},beforeCreate(){let{$options:n}=this,{computed:i,[e]:s}=n;s&&(i={...i},Object.entries(s).forEach((([e,n])=>{let{key:s=e,...l}=function(e,t){let r={};return Object.entries(e).forEach((([e,n])=>{r[e]=t(n)})),r}(n,(e=>r(e)?e.bind(this):e)),u=o(s),a=c((()=>"".concat(t).concat(u())),l);i[e]={get:()=>a.value,set(e){a.value=e}}})),Object.assign(n,{computed:i}))}}}function m(e,t){return{...e,...t}}function g(e,{optionName:t="stored",prefix:r}={}){e.config.optionMergeStrategies[t]=m,e.mixin(f({optionName:t,prefix:r}))}let d={install:g};var p,h;t.isVue2&&(null===(p=globalThis.window)||void 0===p||null===(h=p.Vue)||void 0===h||h.use(d));e.default=d,e.install=g,e.localStorage=i,e.sessionStorage=s,e.stored=c,Object.defineProperty(e,"__esModule",{value:!0})}));
