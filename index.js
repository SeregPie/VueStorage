!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).VueStorage=e()}(this,(function(){"use strict";function t(t){return function(){return t}}function e(t){return"function"==typeof t}function n(n){return e(n)?n:t(n)}function i(t){return t}function o(){}function r(t){if(t){var e=typeof t;return"object"===e||"function"===e}return!1}function s(t){return void 0===t}function u(t){return s(t)||function(t){return null===t}(t)}var f=function(t){this.setOwnItem(t.key,t.newValue)};var a={data:function(){return{items:{}}},methods:{getItem:function(t){var e=this.items[t];if(u(e)){var n=this.storage;n&&(e=n.getItem(t))}return e},setItem:function(t,e){this.setStorageItem(t,e),this.setOwnItem(t,e)},setOwnItem:function(t,e){var n=this.items;this.$set(n,t,e),u(e)&&this.$delete(n,t)},setStorageItem:function(t,e){var n=this.storage;n&&(u(e)?n.removeItem(t):n.setItem(t,e))}}},c={mixins:[a],computed:{storage:function(){if("undefined"!=typeof window)return window.localStorage},storageEventListener:function(){return f.bind(this)}},created:function(){"undefined"!=typeof window&&window.addEventListener("storage",this.storageEventListener)},beforeDestroy:function(){"undefined"!=typeof window&&window.removeEventListener("storage",this.storageEventListener)}};var d={mixins:[a],computed:{storage:function(){if("undefined"!=typeof window)return window.sessionStorage}}},g={install:function(t){Object.assign(t.config.optionMergeStrategies,{stored:function(t,e){return Object.assign({},t,e)}}),this.$localStorage=new t(c),this.$sessionStorage=new t(d),t.mixin(this)},computed:{},beforeCreate:function(){var f=this.$options,a=f.$localStorage,c=f.$sessionStorage,d=f.computed,g=f.stored;g&&Object.entries(g).forEach((function(f){var g=f[0],l=f[1],p=t(g),m=o,w=i,h=i,y=o;l===String||(l===JSON?(w=JSON.parse,h=JSON.stringify):r(l)&&(s(l.key)||(p=n(l.key)),l.type===String||(l.type===JSON?(w=JSON.parse,h=JSON.stringify):r(l.type)&&(e(l.type.parse)&&(w=l.type.parse),e(l.type.stringify)&&(h=l.type.stringify))),s(l.default)||(m=n(l.default)),s(l.session)||(y=n(l.session))));var v=function(){return y.call(this)?c:a};d[g]={get:function(){var t=p.call(this),e=v.call(this).getItem(t);return e=u(e)?m.call(this):w.call(this,e)},set:function(t){var e=p.call(this),n=v.call(this);t=h.call(this,t),n.setItem(e,t)}}}))}};return"undefined"!=typeof window&&window.Vue&&window.Vue.use(g),g}));
