!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueStorage=e()}(this,function(){"use strict";function t(t){return function(){return t}}function e(t){return"function"==typeof t}function n(){}function i(t){return t&&"object"==typeof t}function o(t){return null===t||void 0===t}var r,s={props:{storageType:{default:"local"}},data:function(){return{items:{}}},computed:{storageEventListener:function(){return this.onStorage.bind(this)},storage:function(){switch(this.storageType){case"local":return window.localStorage;case"session":return window.sessionStorage}}},created:function(){window.addEventListener("storage",this.storageEventListener)},beforeDestroy:function(){window.removeEventListener("storage",this.storageEventListener)},methods:{onStorage:function(t){this.setOwnItem(t.key,t.newValue)},getItem:function(t){return this.hasOwnItem(t)||this.setOwnItem(t,this.getStorageItem(t)),this.getOwnItem(t)},setItem:function(t,e){this.setStorageItem(t,e),this.setOwnItem(t,e)},hasOwnItem:function(t){return function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(this.items,t)},getOwnItem:function(t){return this.items[t]},setOwnItem:function(t,e){o(e)&&(e=null),this.$set(this.items,t,e)},getStorageItem:function(t){if(this.storage)return this.storage.getItem(t)},setStorageItem:function(t,e){this.storage&&(o(e)?this.storage.removeItem(t):this.storage.setItem(t,e))}}},u={install:function(t,e){void 0===e&&(e={});var n=e.storageType;void 0===n&&(n=s.props.storageType.default),r||(r=new(t.extend(s))({propsData:{storageType:n}})),t.mixin(this)},computed:{},beforeCreate:function(){var s=this,u=this.$options.stored;u&&Object.entries(u).forEach(function(u){var a=u[0],f=u[1],c=t(a),d=n,g=String,p=String;f===String||(f===JSON?(g=JSON.parse.bind(JSON),p=JSON.stringify.bind(JSON)):i(f)&&(c=e(f.key)?f.key.bind(s):t(String(f.key)),d=e(f.default)?f.default.bind(s):t(f.default),f.type===String||(f.type===JSON?(g=JSON.parse.bind(JSON),p=JSON.stringify.bind(JSON)):i(f.type)&&(e(f.type.parse)&&(g=f.type.parse.bind(s)),e(f.type.stringify)&&(p=f.type.stringify.bind(s)))))),s.$options.computed[a]={get:function(){var t=c(),e=r.getItem(t);return e=o(e)?d():g(e)},set:function(t){var e=c();o(t)||(t=p(t)),r.setItem(e,t)}}})}};return"undefined"!=typeof window&&window.Vue&&window.Vue.use(u),u});
