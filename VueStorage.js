!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).VueStorage=e()}(this,function(){"use strict";function t(t){return function(){return t}}function e(t){return"function"==typeof t}function n(){}function i(t){return function(t){return void 0===t}(t)||function(t){return null===t}(t)}function r(t){return t&&"object"==typeof t}var o=function(t){this.setOwnItem(t.key,t.newValue)};var s,u={props:{storageType:{default:"local"}},data:function(){return{items:{}}},computed:{storage:function(){switch(this.storageType){case"local":return window.localStorage;case"session":return window.sessionStorage}},storageEventListener:function(){return o.bind(this)}},created:function(){window.addEventListener("storage",this.storageEventListener)},beforeDestroy:function(){window.removeEventListener("storage",this.storageEventListener)},methods:{getItem:function(t){return this.hasOwnItem(t)||this.setOwnItem(t,this.getStorageItem(t)),this.getOwnItem(t)},getOwnItem:function(t){return this.items[t]},getStorageItem:function(t){if(this.storage)return this.storage.getItem(t)},hasOwnItem:function(t){return function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(this.items,t)},setItem:function(t,e){this.setStorageItem(t,e),this.setOwnItem(t,e)},setOwnItem:function(t,e){i(e)&&(e=null),this.$set(this.items,t,e)},setStorageItem:function(t,e){this.storage&&(i(e)?this.storage.removeItem(t):this.storage.setItem(t,e))}}},a={install:function(t,e){void 0===e&&(e={});var n=e.storageType;void 0===n&&(n=u.props.storageType.default),Object.assign(t.config.optionMergeStrategies,{stored:function(t,e){return Object.assign({},t,e)}}),s=new(t.extend(u))({propsData:{storageType:n}}),t.mixin(this)},computed:{},beforeCreate:function(){var o=this,u=this.$options,a=u.computed,f=u.stored;f&&Object.entries(f).forEach(function(u){var f=u[0],c=u[1],d=t(f),g=n,p=String,m=String;c===String||(c===JSON?(p=JSON.parse.bind(JSON),m=JSON.stringify.bind(JSON)):r(c)&&(d=e(c.key)?c.key.bind(o):t(String(c.key)),g=e(c.default)?c.default.bind(o):t(c.default),c.type===String||(c.type===JSON?(p=JSON.parse.bind(JSON),m=JSON.stringify.bind(JSON)):r(c.type)&&(e(c.type.parse)&&(p=c.type.parse.bind(o)),e(c.type.stringify)&&(m=c.type.stringify.bind(o)))))),a[f]={get:function(){var t=d(),e=s.getItem(t);return e=i(e)?g():p(e)},set:function(t){var e=d();i(t)||(t=m(t)),s.setItem(e,t)}}})}};return"undefined"!=typeof window&&window.Vue&&window.Vue.use(a),a});
