!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueStorage=e()}(this,function(){"use strict";var t,e=function(t){return function(){return t}},n=function(t){return"function"==typeof t},i=function(){},o=function(t){return t&&"object"==typeof t},r=function(t){return null===t||void 0===t},s={props:{storageType:{default:"local"}},data:function(){return{items:{}}},created:function(){window.addEventListener("storage",this.storageEventListener)},beforeDestroy:function(){window.removeEventListener("storage",this.storageEventListener)},computed:{storageEventListener:function(){return this.onStorage.bind(this)},storage:function(){switch(this.storageType){case"local":return window.localStorage;case"session":return window.sessionStorage}}},methods:{onStorage:function(t){this.setOwnItem(t.key,t.newValue)},getItem:function(t){return this.hasOwnItem(t)||this.setOwnItem(t,this.getStorageItem(t)),this.getOwnItem(t)},setItem:function(t,e){this.setStorageItem(t,e),this.setOwnItem(t,e)},hasOwnItem:function(t){return function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(this.items,t)},getOwnItem:function(t){return this.items[t]},setOwnItem:function(t,e){r(e)&&(e=null),Vue.set(this.items,t,e)},getStorageItem:function(t){if(this.storage)return this.storage.getItem(t)},setStorageItem:function(t,e){this.storage&&(r(e)?this.storage.removeItem(t):this.storage.setItem(t,e))}}},u={install:function(e,n){void 0===n&&(n={});var i=n.storageType;void 0===i&&(i=s.props.storageType.default),t||(t=new(e.extend(s))({propsData:{storageType:i}})),e.mixin(this)},beforeCreate:function(){var s=this,u=this.$options.stored;u&&Object.entries(u).forEach(function(u){var a=u[0],f=u[1],c=e(a),d=i,g=String,p=String;f===String||(f===JSON?(g=JSON.parse.bind(JSON),p=JSON.stringify.bind(JSON)):o(f)&&(c=n(f.key)?f.key.bind(s):e(String(f.key)),d=n(f.default)?f.default.bind(s):e(f.default),f.type===String||(f.type===JSON?(g=JSON.parse.bind(JSON),p=JSON.stringify.bind(JSON)):o(f.type)&&(n(f.type.parse)&&(g=f.type.parse.bind(s)),n(f.type.stringify)&&(p=f.type.stringify.bind(s)))))),s.$options.computed[a]={get:function(){var e=c(),n=t.getItem(e);return n=r(n)?d():g(n)},set:function(e){var n=c();r(e)||(e=p(e)),t.setItem(n,e)}}})},computed:{}};return"undefined"!=typeof window&&window.Vue&&window.Vue.use(u),u});
